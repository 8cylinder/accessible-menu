var AccessibleMenu=function(){"use strict";var e,t,n,s;Array.from||(Array.from=(e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},n=Math.pow(2,53)-1,s=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),n)},function(e){var n=this,r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,i=arguments.length>1?arguments[1]:void 0;if(void 0!==i){if(!t(i))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var l,u=s(r.length),c=t(n)?Object(new n(u)):new Array(u),m=0;m<u;)l=r[m],c[m]=i?void 0===o?i(l,m):i.call(o,l,m):l,m+=1;return c.length=u,c})),Array.includes||(Array.prototype.includes=function(e){return!!~this.indexOf(e)}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var s=arguments[1],r=0;r<n;){var o=t[r];if(e.call(s,o,r,t))return o;r++}},configurable:!0,writable:!0}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var n=t>0?0|t:0;return this.substring(n,n+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),"Symbol"in self&&0===self.Symbol.length||function(e,t,n){var s,r=function(){try{var t={};return e.defineProperty(t,"t",{configurable:!0,enumerable:!1,get:function(){return!0},set:void 0}),!!t.t}catch(e){return!1}}(),o=0,i=""+Math.random(),l="__symbol:",u=l.length,c="__symbol@@"+i,m={},h="defineProperty",a="defineProperties",d="getOwnPropertyNames",f="getOwnPropertyDescriptor",p="propertyIsEnumerable",g=e.prototype,b=g.hasOwnProperty,y=g[p],v=g.toString,E=Array.prototype.concat,M=e.getOwnPropertyNames?e.getOwnPropertyNames(self):[],C=e[d],w=function(e){if("[object Window]"===v.call(e))try{return C(e)}catch(e){return E.call([],M)}return C(e)},T=e[f],S=e.create,I=e.keys,L=e.freeze||e,A=e[h],k=e[a],O=T(e,d),$=function(e,t,n){if(!b.call(e,c))try{A(e,c,{enumerable:!1,configurable:!1,writable:!1,value:{}})}catch(t){e[c]={}}e[c]["@@"+t]=n},j=function(e,t){var n=S(e);return w(t).forEach((function(e){z.call(t,e)&&R(n,e,t[e])})),n},D=function(){},x=function(e){return e!=c&&!b.call(H,e)},F=function(e){return e!=c&&b.call(H,e)},z=function(e){var t=""+e;return F(t)?b.call(this,t)&&this[c]&&this[c]["@@"+t]:y.call(this,e)},P=function(t){var n={enumerable:!1,configurable:!0,get:D,set:function(e){s(this,t,{enumerable:!1,configurable:!0,writable:!0,value:e}),$(this,t,!0)}};try{A(g,t,n)}catch(e){g[t]=n.value}H[t]=A(e(t),"constructor",V);var r=T(K.prototype,"description");return r&&A(H[t],"description",r),L(H[t])},N=function(e){var t=function(e){if("symbol"===Type(e))return e;throw TypeError(e+" is not a symbol")}(e);if(_){var n=B(t);if(""!==n)return n.slice(1,-1)}if(void 0!==m[t])return m[t];var s=t.toString(),r=s.lastIndexOf("0.");return""!==(s=s.slice(10,r))?s:void 0},K=function t(){var n=arguments[0];if(this instanceof t)throw new TypeError("Symbol is not a constructor");var s=l.concat(n||"",i,++o);void 0===n||null!==n&&!isNaN(n)&&""!==String(n)||(m[s]=String(n));var u=P(s);return r||e.defineProperty(u,"description",{configurable:!0,enumerable:!1,value:N(u)}),u},H=S(null),V={value:K},q=function(e){return H[e]},R=function(e,t,n){var r=""+t;return F(r)?(s(e,r,n.enumerable?function(e){var t=S(e);return t.enumerable=!1,t}(n):n),$(e,r,!!n.enumerable)):A(e,t,n),e},W=function(e){return w(e).filter(e===g?(t=e,function(e){return b.call(t,c)&&b.call(t[c],"@@"+e)}):F).map(q);var t};O.value=R,A(e,h,O),O.value=W,A(e,"getOwnPropertySymbols",O),O.value=function(e){return w(e).filter(x)},A(e,d,O),O.value=function(e,t){var n=W(t);return n.length?I(t).concat(n).forEach((function(n){z.call(t,n)&&R(e,n,t[n])})):k(e,t),e},A(e,a,O),O.value=z,A(g,p,O),O.value=K,A(n,"Symbol",O),O.value=function(e){var t=l.concat(l,e,i);return t in g?H[t]:P(t)},A(K,"for",O),O.value=function(e){if(x(e))throw new TypeError(e+" is not a symbol");return b.call(H,e)?e.slice(2*u,-i.length):void 0},A(K,"keyFor",O),O.value=function(e,t){var n=T(e,t);return n&&F(t)&&(n.enumerable=z.call(e,t)),n},A(e,f,O),O.value=function(e,t){return 1===arguments.length||void 0===t?S(e):j(e,t)},A(e,"create",O);var U=null===function(){return this}.call(null);if(O.value=U?function(){var e=v.call(this);return"[object String]"===e&&F(this)?"[object Symbol]":e}:function(){if(this===window)return"[object Null]";var e=v.call(this);return"[object String]"===e&&F(this)?"[object Symbol]":e},A(g,"toString",O),s=function(e,t,n){var s=T(g,t);delete g[t],A(e,t,n),e!==g&&A(g,t,s)},function(){try{var t={};return e.defineProperty(t,"t",{configurable:!0,enumerable:!1,get:function(){return!0},set:void 0}),!!t.t}catch(e){return!1}}()){var B;try{B=Function("s","var v = s.valueOf(); return { [v]() {} }[v].name;")}catch(e){}var _=B&&"inferred"===function(){}.name?B:null;e.defineProperty(n.Symbol.prototype,"description",{configurable:!0,enumerable:!1,get:function(){return N(this)}})}}(Object,0,self),function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}}();const r=Symbol("BaseMenu"),o=Symbol("BaseMenuToggle");function i(e){try{if("object"!=typeof e){throw new TypeError(`Elements given to isHTMLElement() must be inside of an object. ${typeof e} given.`)}for(const t in e)if(!(e[t]instanceof HTMLElement)){const n=typeof e[t];throw new TypeError(`${t} must be an instance of HTMLElement. ${n} given.`)}return!0}catch(e){return console.error(e),!1}}function l(e){try{if("object"!=typeof e){throw new TypeError(`Values given to isCSSSelector() must be inside of an object. ${typeof e} given.`)}for(const t in e)try{document.querySelector(e[t])}catch(n){throw new TypeError(`${t} must be a valid CSS selector. "${e[t]}" given.`)}return!0}catch(e){return console.error(e),!1}}function u(e){try{if("object"!=typeof e){throw new TypeError(`Values given to isBoolean() must be inside of an object. ${typeof e} given.`)}for(const t in e){const n=typeof e[t];if("boolean"!==n)throw new TypeError(`${t} must be a boolean. ${n} given.`)}return!0}catch(e){return console.error(e),!1}}function c(e){try{if("object"!=typeof e){throw new TypeError(`Values given to isNumber() must be inside of an object. ${typeof e} given.`)}for(const t in e){const n=typeof e[t];if("number"!==n)throw new TypeError(`${t} must be a number. ${n} given.`)}return!0}catch(e){return console.error(e),!1}}function m(e){try{if("object"!=typeof e){throw new TypeError(`Values given to isString() must be inside of an object. ${typeof e} given.`)}for(const t in e){const n=typeof e[t];if("string"!==n)throw new TypeError(`${t} must be a string. ${n} given.`)}return!0}catch(e){return console.error(e),!1}}function h(e){try{if("object"!=typeof e){throw new TypeError(`Elements given to isMenu() must be inside of an object. ${typeof e} given.`)}for(const t in e)if(!e[t][r]){const n=typeof e[t];throw new TypeError(`${t} must be an instance of BaseMenu. ${n} given.`)}return!0}catch(e){return console.error(e),!1}}function a(e,t){m({event:e}),i({element:t});return void 0!==t[`on${e}`]}function d(e){try{if("object"!=typeof e){throw new TypeError(`Values given to isValidClassList() must be inside of an object. ${typeof e} given.`)}for(const t in e){const n=typeof e[t];if("string"!==n){if(!Array.isArray(e[t]))throw new TypeError(`${t} must be a string or an array of strings. ${n} given.`);e[t].forEach((e=>{m({classValue:e})}))}}return!0}catch(e){return console.error(e),!1}}class f{constructor({menuToggleElement:e,parentElement:t,controlledMenu:n,parentMenu:s=null}){i({menuToggleElement:e,parentElement:t}),h(null!==s?{controlledMenu:n,parentMenu:s}:{controlledMenu:n}),this.domElements={toggle:e,parent:t},this.menuElements={controlledMenu:n,parentMenu:s},this.isOpen=!1,this.expandEvent=new CustomEvent("accessibleMenuExpand",{bubbles:!0,detail:{toggle:this}}),this.collapseEvent=new CustomEvent("accessibleMenuCollapse",{bubbles:!0,detail:{toggle:this}}),this.initialize()}initialize(){const{closeClass:e}=this.elements.controlledMenu;if(this.dom.toggle.setAttribute("aria-haspopup","true"),this.dom.toggle.setAttribute("aria-expanded","false"),function(e,t){if(m({tagName:e})&&i(t)){const n=e.toLowerCase();let s=!0;for(const e in t)t[e].tagName.toLowerCase()!==n&&(s=!1);return s}return!1}("button",{toggle:this.dom.toggle})||this.dom.toggle.setAttribute("role","button"),""===this.dom.toggle.id||""===this.elements.controlledMenu.dom.menu.id){const e=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,10);let t=this.dom.toggle.innerText.replace(/[^a-zA-Z0-9\s]/g,""),n=e;!t.replace(/\s/g,"").length&&this.dom.toggle.getAttribute("aria-label")&&(t=this.dom.toggle.getAttribute("aria-label").replace(/[^a-zA-Z0-9\s]/g,"")),t.replace(/\s/g,"").length>0&&(t=t.toLowerCase().replace(/\s+/g,"-"),t.startsWith("-")&&(t=t.substring(1)),t.endsWith("-")&&(t=t.slice(0,-1)),n=`${t}-${n}`),this.dom.toggle.id=this.dom.toggle.id||`${n}-menu-button`,this.elements.controlledMenu.dom.menu.id=this.elements.controlledMenu.dom.menu.id||`${n}-menu`}this.elements.controlledMenu.dom.menu.setAttribute("aria-labelledby",this.dom.toggle.id),this.dom.toggle.setAttribute("aria-controls",this.elements.controlledMenu.dom.menu.id),""!==e&&("string"==typeof e?this.elements.controlledMenu.dom.menu.classList.add(e):Array.isArray(e)&&e.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.add(e)})))}get dom(){return this.domElements}get elements(){return this.menuElements}get isOpen(){return this.show}set isOpen(e){u({value:e}),this.show=e}expand(){const{closeClass:e,openClass:t}=this.elements.controlledMenu;this.dom.toggle.setAttribute("aria-expanded","true"),""!==t&&("string"==typeof t?this.elements.controlledMenu.dom.menu.classList.add(t):Array.isArray(t)&&t.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.add(e)}))),""!==e&&("string"==typeof e?this.elements.controlledMenu.dom.menu.classList.remove(e):Array.isArray(e)&&e.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.remove(e)}))),this.dom.toggle.dispatchEvent(this.expandEvent)}collapse(){const{closeClass:e,openClass:t}=this.elements.controlledMenu;this.dom.toggle.setAttribute("aria-expanded","false"),""!==e&&("string"==typeof e?this.elements.controlledMenu.dom.menu.classList.add(e):Array.isArray(e)&&e.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.add(e)}))),""!==t&&("string"==typeof t?this.elements.controlledMenu.dom.menu.classList.remove(t):Array.isArray(t)&&t.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.remove(e)}))),this.dom.toggle.dispatchEvent(this.collapseEvent)}open(){this.isOpen=!0,this.expand(),this.closeSiblings(),this.elements.parentMenu&&(this.elements.parentMenu.focusState="child"),this.elements.controlledMenu.focusState="self"}preview(){this.isOpen=!0,this.expand(),this.closeSiblings(),this.elements.parentMenu&&(this.elements.parentMenu.focusState="self"),this.elements.controlledMenu.focusState="none"}close(){this.isOpen&&(this.isOpen=!1,this.collapse(),this.closeChildren(),this.elements.controlledMenu.currentChild=0,this.elements.controlledMenu.blur(),this.elements.parentMenu&&(this.elements.parentMenu.focusState="self"))}toggle(){this.isOpen?this.close():this.open()}closeSiblings(){this.elements.parentMenu&&this.elements.parentMenu.elements.submenuToggles.forEach((e=>{e!==this&&e.close()}))}closeChildren(){this.elements.controlledMenu.elements.submenuToggles.forEach((e=>e.close()))}get[o](){return!0}}class p{constructor({menuItemElement:e,menuLinkElement:t,parentMenu:n,isSubmenuItem:s=!1,childMenu:r=null,toggle:l=null}){i({menuItemElement:e,menuLinkElement:t}),u({isSubmenuItem:s}),h(null!==r?{parentMenu:n,childMenu:r}:{parentMenu:n}),null!==l&&function(e){try{if("object"!=typeof e)throw new TypeError(`Elements given to isMenuToggle() must be inside of an object. ${typeof e} given.`);for(const t in e)if(!e[t][o]){const n=typeof e[t];throw new TypeError(`${t} must be an instance of BaseMenuToggle. ${n} given.`)}}catch(e){return console.error(e),!1}}({toggle:l}),this.domElements={item:e,link:t},this.menuElements={parentMenu:n,childMenu:r,toggle:l},this.isController=s}initialize(){}get dom(){return this.domElements}get elements(){return this.menuElements}get isSubmenuItem(){return this.isController}focus(){"mouse"!==this.elements.parentMenu.currentEvent&&this.dom.link.focus()}blur(){"mouse"!==this.elements.parentMenu.currentEvent&&this.dom.link.blur()}}function g(e){try{const t=e.key||e.keyCode,n={Enter:"Enter"===t||13===t,Space:" "===t||"Spacebar"===t||32===t,Escape:"Escape"===t||"Esc"===t||27===t,ArrowUp:"ArrowUp"===t||"Up"===t||38===t,ArrowRight:"ArrowRight"===t||"Right"===t||39===t,ArrowDown:"ArrowDown"===t||"Down"===t||40===t,ArrowLeft:"ArrowLeft"===t||"Left"===t||37===t,Home:"Home"===t||36===t,End:"End"===t||35===t,Character:!!t.match(/^[a-zA-Z]{1}$/),Tab:"Tab"===t||9===t};return Object.keys(n).find((e=>!0===n[e]))||""}catch(e){return""}}function b(e){e.preventDefault(),e.stopPropagation()}class y{constructor({menuElement:e,menuItemSelector:t="li",menuLinkSelector:n="a",submenuItemSelector:s="",submenuToggleSelector:r="a",submenuSelector:o="ul",controllerElement:c=null,containerElement:m=null,openClass:a="show",closeClass:d="hide",isTopLevel:g=!0,parentMenu:b=null,hoverType:v="off",hoverDelay:E=250}){u({isTopLevel:g}),l(""!==s?{menuItemSelector:t,menuLinkSelector:n,submenuItemSelector:s,submenuToggleSelector:r,submenuSelector:o}:{menuItemSelector:t,menuLinkSelector:n}),i(null!==c||null!==m?{menuElement:e,controllerElement:c,containerElement:m}:{menuElement:e}),null!==b&&h({parentMenu:b}),this.domElements={menu:e,menuItems:[],submenuItems:[],submenuToggles:[],submenus:[],controller:c,container:m},this.domSelectors={menuItems:t,menuLinks:n,submenuItems:s,submenuToggles:r,submenus:o},this.menuElements={menuItems:[],submenuToggles:[],controller:null,parentMenu:b,rootMenu:g?this:null},this.openClass=a||"",this.closeClass=d||"",this.root=g,this.currentChild=0,this.focusState="none",this.currentEvent="none",this.hoverType=v,this.hoverDelay=E,this.MenuType=y,this.MenuItemType=p,this.MenuToggleType=f}initialize(){const{MenuToggleType:e}=this;if(null===this.elements.rootMenu&&this.findRootMenu(this),this.setDOMElements(),this.isTopLevel&&this.dom.controller&&this.dom.container){const t=new e({menuToggleElement:this.dom.controller,parentElement:this.dom.container,controlledMenu:this,openClass:this.openClass,closeClass:this.closeClass});this.menuElements.controller=t}this.createChildElements()}get dom(){return this.domElements}get selectors(){return this.domSelectors}get elements(){return this.menuElements}get openClass(){return this.isTopLevel?this.submenuOpenClass:this.elements.rootMenu.openClass}get closeClass(){return this.isTopLevel?this.submenuCloseClass:this.elements.rootMenu.closeClass}get isTopLevel(){return this.root}get currentChild(){return this.focussedChild}get focusState(){return this.state}get currentEvent(){return this.event}get currentMenuItem(){return this.elements.menuItems[this.currentChild]}get hoverType(){return this.isTopLevel?this.hover:this.elements.rootMenu.hoverType}get hoverDelay(){return this.isTopLevel?this.delay:this.elements.rootMenu.hoverDelay}set openClass(e){d({openClass:e}),this.submenuOpenClass=e}set closeClass(e){d({closeClass:e}),this.submenuCloseClass=e}set currentChild(e){c({value:e}),this.focussedChild=e}set focusState(e){!function(e){try{if("object"!=typeof e)throw new TypeError(`Values given to isValidState() must be inside of an object. ${typeof e} given.`);const t=["none","self","child"];for(const n in e)if(!t.includes(e[n]))throw new TypeError(`${n} must be one of the following values: ${t.join(", ")}. "${e[n]}" given.`)}catch(e){return console.error(e),!1}}({value:e}),this.state=e}set currentEvent(e){!function(e){try{if("object"!=typeof e)throw new TypeError(`Values given to isValidEvent() must be inside of an object. ${typeof e} given.`);const t=["none","mouse","keyboard"];for(const n in e)if(!t.includes(e[n]))throw new TypeError(`${n} must be one of the following values: ${t.join(", ")}. "${e[n]}" given.`)}catch(e){return console.error(e),!1}}({value:e}),this.event=e}set hoverType(e){!function(e){try{if("object"!=typeof e)throw new TypeError(`Values given to isValidHoverType() must be inside of an object. ${typeof e} given.`);const t=["off","on","dynamic"];for(const n in e)if(!t.includes(e[n]))throw new TypeError(`${n} must be one of the following values: ${t.join(", ")}. "${e[n]}" given.`)}catch(e){return console.error(e),!1}}({value:e}),this.hover=e}set hoverDelay(e){c({value:e}),this.delay=e}setDOMElementType(e,t,n){if("string"!=typeof this.selectors[e])throw new Error(`${e} is not a valid element type within the menu.`);{t&&i({base:t});const s=t||this.dom.menu,r=e=>e.parentElement===s,o=this.selectors[e],l=Array.from(s.querySelectorAll(o));this.domElements[e]=void 0!==n?"function"==typeof n?l.filter((e=>n(e))):l:l.filter((e=>r(e)))}}addDOMElementType(e,t,n){if("string"!=typeof this.selectors[e])throw new Error(`${e} is not a valid element type within the menu.`);{t&&i({base:t});const s=t||this.dom.menu,r=e=>e.parentElement===s,o=this.selectors[e],l=Array.from(s.querySelectorAll(o));this.domElements[e]=void 0!==n?"function"==typeof n?[...this.domElements[e],...l.filter((e=>n(e)))]:[...this.domElements[e],...l]:[...this.domElements[e],...l.filter((e=>r(e)))]}}clearDOMElementType(e){if("menu"!==e)if(Array.isArray(this.domElements[e]))this.domElements[e]=[];else{if(void 0===this.domElements[e])throw new Error(`${e} is not a valid element type within the menu.`);this.domElements[e]=null}}setDOMElements(){this.setDOMElementType("menuItems"),""!==this.selectors.submenuItems&&(this.setDOMElementType("submenuItems"),this.clearDOMElementType("submenuToggles"),this.clearDOMElementType("submenus"),this.dom.submenuItems.forEach((e=>{this.addDOMElementType("submenuToggles",e),this.addDOMElementType("submenus",e)})))}findRootMenu(e){if(e.isTopLevel)this.menuElements.rootMenu=e;else{if(null===e.elements.parentMenu)throw new Error("Cannot find root menu.");this.findRootMenu(e.elements.parentMenu)}}createChildElements(){const{MenuType:e,MenuItemType:t,MenuToggleType:n}=this;this.dom.menuItems.forEach((s=>{let r;if(this.dom.submenuItems.includes(s)){const o=s.querySelector(this.selectors.submenuToggles),i=s.querySelector(this.selectors.submenus),l=new e({menuElement:i,menuItemSelector:this.selectors.menuItems,menuLinkSelector:this.selectors.menuLinks,submenuItemSelector:this.selectors.submenuItems,submenuToggleSelector:this.selectors.submenuToggles,submenuSelector:this.selectors.submenus,openClass:this.openClass,closeClass:this.closeClass,isTopLevel:!1,parentMenu:this,hoverType:this.hoverType,hoverDelay:this.hoverDelay}),u=new n({menuToggleElement:o,parentElement:s,controlledMenu:l,parentMenu:this});this.menuElements.submenuToggles.push(u),r=new t({menuItemElement:s,menuLinkElement:o,parentMenu:this,isSubmenuItem:!0,childMenu:l,toggle:u})}else{const e=s.querySelector(this.selectors.menuLinks);r=new t({menuItemElement:s,menuLinkElement:e,parentMenu:this})}this.menuElements.menuItems.push(r)}))}handleFocus(){this.elements.menuItems.forEach(((e,t)=>{e.dom.link.addEventListener("focus",(()=>{this.elements.parentMenu&&(this.elements.parentMenu.focusState="child"),e.elements.childMenu&&(e.elements.childMenu.focusState="none"),this.focusState="self",this.currentChild=t}))}))}handleClick(){function e(e,t,n){b(n),e.currentEvent="mouse",t.toggle(),t.isOpen&&(e.focusState="self",t.elements.controlledMenu.focusState="none")}document.addEventListener("mouseup",(e=>{"none"!==this.focusState&&(this.currentEvent="mouse",this.dom.menu.contains(e.target)||!this.dom.menu===e.target||(this.closeChildren(),this.blur(),this.elements.controller&&this.elements.controller.close()))})),this.elements.submenuToggles.forEach((t=>{a("touchend",t.dom.toggle)?t.dom.toggle.ontouchend=n=>{e(this,t,n)}:t.dom.toggle.onmouseup=n=>{e(this,t,n)}})),this.isTopLevel&&this.elements.controller&&(a("touchend",this.elements.controller.dom.toggle)?this.elements.controller.dom.toggle.ontouchend=t=>{e(this,this.elements.controller,t)}:this.elements.controller.dom.toggle.onmouseup=t=>{e(this,this.elements.controller,t)})}handleHover(){this.elements.submenuToggles.forEach((e=>{e.dom.parent.addEventListener("mouseenter",(()=>{if("on"===this.hoverType)this.currentEvent="mouse",e.open();else if("dynamic"===this.hoverType){const t=this.elements.submenuToggles.some((e=>e.isOpen));this.isTopLevel&&!t||(this.currentEvent="mouse",e.open())}})),e.dom.parent.addEventListener("mouseleave",(()=>{"on"===this.hoverType?setTimeout((()=>{this.currentEvent="mouse",e.close()}),this.hoverDelay):"dynamic"===this.hoverType&&(this.isTopLevel||(this.currentEvent="mouse",e.close()))}))}))}handleKeydown(){this.isTopLevel&&this.elements.controller&&this.elements.controller.dom.toggle.addEventListener("keydown",(e=>{this.currentEvent="keyboard";const t=g(e);"Space"!==t&&"Enter"!==t||b(e)}))}handleKeyup(){this.isTopLevel&&this.elements.controller&&this.elements.controller.dom.toggle.addEventListener("keyup",(e=>{this.currentEvent="keyboard";const t=g(e);"Space"!==t&&"Enter"!==t||(b(e),this.elements.controller.open(),this.focusFirstChild())}))}focus(){this.focusState="self","mouse"!==this.currentEvent&&this.dom.menu.focus()}blur(){this.focusState="none","mouse"!==this.currentEvent&&this.dom.menu.blur(),this.isTopLevel&&this.elements.controller&&this.elements.controller.close()}focusFirstChild(){this.blurCurrentChild(),this.currentChild=0,this.focusCurrentChild()}focusLastChild(){this.blurCurrentChild(),this.currentChild=this.elements.menuItems.length-1,this.focusCurrentChild()}focusNextChild(){this.currentChild===this.elements.menuItems.length-1?this.focusFirstChild():(this.blurCurrentChild(),this.currentChild=this.currentChild+1,this.focusCurrentChild())}focusPreviousChild(){0===this.currentChild?this.focusLastChild():(this.blurCurrentChild(),this.currentChild=this.currentChild-1,this.focusCurrentChild())}focusCurrentChild(){-1!==this.currentChild&&this.currentMenuItem.focus()}blurCurrentChild(){-1!==this.currentChild&&this.currentMenuItem.blur()}focusNextChildWithCharacter(e){const t=e.toLowerCase();let n=this.currentChild+1,s=!1;for(;!s&&n<this.elements.menuItems.length;){this.elements.menuItems[n].dom.item.innerText.toLowerCase().startsWith(t)&&(s=!0,this.currentChild=n,this.focusCurrentChild()),n++}}focusController(){this.dom.controller&&("mouse"!==this.currentEvent&&this.dom.controller.focus(),this.focusState="none")}focusContainer(){this.dom.container&&("mouse"!==this.currentEvent&&this.dom.container.focus(),this.focusState="none")}closeChildren(){this.elements.submenuToggles.forEach((e=>e.close()))}get[r](){return!0}}class v extends p{constructor({menuItemElement:e,menuLinkElement:t,parentMenu:n,isSubmenuItem:s=!1,childMenu:r=null,toggle:o=null}){super({menuItemElement:e,menuLinkElement:t,parentMenu:n,isSubmenuItem:s,childMenu:r,toggle:o}),this.initialize()}initialize(){super.initialize(),this.dom.item.setAttribute("role","none"),this.dom.link.setAttribute("role","menuitem"),this.dom.link.tabIndex=-1}focus(){super.focus(),this.elements.parentMenu.isTopLevel&&(this.dom.link.tabIndex=0)}blur(){super.blur(),this.elements.parentMenu.isTopLevel&&(this.dom.link.tabIndex=-1)}}class E extends f{constructor({menuToggleElement:e,parentElement:t,controlledMenu:n,openClass:s="show",closeClass:r="hide",parentMenu:o=null}){super({menuToggleElement:e,parentElement:t,controlledMenu:n,openClass:s,closeClass:r,parentMenu:o}),this.initialize()}}class M extends y{constructor({menuElement:e,menuItemSelector:t="li",menuLinkSelector:n="a",submenuItemSelector:s="",submenuToggleSelector:r="a",submenuSelector:o="ul",controllerElement:i=null,containerElement:l=null,openClass:u="show",closeClass:c="hide",isTopLevel:m=!0,parentMenu:h=null,hoverType:a="off",hoverDelay:d=250}){super({menuElement:e,menuItemSelector:t,menuLinkSelector:n,submenuItemSelector:s,submenuToggleSelector:r,submenuSelector:o,controllerElement:i,containerElement:l,openClass:u,closeClass:c,isTopLevel:m,parentMenu:h,hoverType:a,hoverDelay:d}),this.MenuType=M,this.MenuItemType=v,this.MenuToggleType=E,this.initialize()}initialize(){super.initialize(),this.dom.menu.setAttribute("role","menubar"),this.handleFocus(),this.handleClick(),this.handleHover(),this.handleKeydown(),this.handleKeyup(),this.elements.menuItems[0].dom.link.tabIndex=0}handleKeydown(){super.handleKeydown(),this.dom.menu.addEventListener("keydown",(e=>{this.currentEvent="keyboard";const t=g(e);if("Tab"===t&&("none"!==this.elements.rootMenu.focusState?(this.elements.rootMenu.blur(),this.elements.rootMenu.closeChildren()):this.elements.rootMenu.focus()),"Character"===t)b(e);else if(this.isTopLevel){if("self"===this.focusState){const n=["Space","Enter","ArrowDown","ArrowUp"],s=["Escape"];(["ArrowRight","ArrowLeft","Home","End"].includes(t)||this.currentMenuItem.isSubmenuItem&&n.includes(t)||this.elements.controller&&s.includes(t))&&b(e)}}else{const n=["Space","Enter"];(["Escape","ArrowRight","ArrowLeft","ArrowDown","ArrowUp","Home","End"].includes(t)||this.currentMenuItem.isSubmenuItem&&n.includes(t))&&b(e)}}))}handleKeyup(){super.handleKeyup(),this.dom.menu.addEventListener("keyup",(e=>{this.currentEvent="keyboard";const t=g(e),{altKey:n,crtlKey:s,metaKey:r}=e;if("Character"!==t||(n||s||r))if(this.isTopLevel){if("self"===this.focusState)if("Space"===t||"Enter"===t)this.currentMenuItem.isSubmenuItem&&(b(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()})));else if("ArrowRight"===t){b(e);const t=this.currentMenuItem.isSubmenuItem&&this.currentMenuItem.elements.toggle.isOpen;this.focusNextChild(),t&&(this.currentMenuItem.isSubmenuItem?this.currentMenuItem.elements.toggle.preview():this.closeChildren())}else if("ArrowLeft"===t){b(e);const t=this.currentMenuItem.isSubmenuItem&&this.currentMenuItem.elements.toggle.isOpen;this.focusPreviousChild(),t&&(this.currentMenuItem.isSubmenuItem?this.currentMenuItem.elements.toggle.preview():this.closeChildren())}else if("ArrowDown"===t)this.currentMenuItem.isSubmenuItem&&(b(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()})));else if("ArrowUp"===t)this.currentMenuItem.isSubmenuItem&&(b(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusLastChild()})));else if("Home"===t)b(e),this.focusFirstChild();else if("End"===t)b(e),this.focusLastChild();else if("Escape"===t){this.elements.submenuToggles.some((e=>e.isOpen))?(b(e),this.closeChildren()):this.isTopLevel&&this.elements.controller&&this.elements.controller.isOpen&&(b(e),this.elements.controller.close(),this.focusController())}}else"Space"===t||"Enter"===t?this.currentMenuItem.isSubmenuItem&&(b(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()}))):"Escape"===t?(b(e),this.elements.rootMenu.closeChildren(),this.elements.rootMenu.focusCurrentChild()):"ArrowRight"===t?this.currentMenuItem.isSubmenuItem?(b(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()}))):(b(e),this.elements.rootMenu.closeChildren(),this.elements.rootMenu.focusNextChild(),this.elements.rootMenu.currentMenuItem.isSubmenuItem&&this.elements.rootMenu.currentMenuItem.elements.toggle.preview()):"ArrowLeft"===t?this.elements.parentMenu.currentMenuItem.isSubmenuItem&&(b(e),this.elements.parentMenu.currentMenuItem.elements.toggle.close(),this.elements.parentMenu.focusCurrentChild(),this.elements.parentMenu===this.elements.rootMenu&&(this.elements.rootMenu.closeChildren(),this.elements.rootMenu.focusPreviousChild(),this.elements.rootMenu.currentMenuItem.isSubmenuItem&&this.elements.rootMenu.currentMenuItem.elements.toggle.preview())):"ArrowDown"===t?(b(e),this.focusNextChild()):"ArrowUp"===t?(b(e),this.focusPreviousChild()):"Home"===t?(b(e),this.focusFirstChild()):"End"===t&&(b(e),this.focusLastChild());else b(e),this.focusNextChildWithCharacter(e.key)}))}}class C extends p{constructor({menuItemElement:e,menuLinkElement:t,parentMenu:n,isSubmenuItem:s=!1,childMenu:r=null,toggle:o=null}){super({menuItemElement:e,menuLinkElement:t,parentMenu:n,isSubmenuItem:s,childMenu:r,toggle:o}),this.initialize()}}class w extends f{constructor({menuToggleElement:e,parentElement:t,controlledMenu:n,openClass:s="show",closeClass:r="hide",parentMenu:o=null}){super({menuToggleElement:e,parentElement:t,controlledMenu:n,openClass:s,closeClass:r,parentMenu:o}),this.initialize()}}class T extends y{constructor({menuElement:e,menuItemSelector:t="li",menuLinkSelector:n="a",submenuItemSelector:s="",submenuToggleSelector:r="a",submenuSelector:o="ul",controllerElement:i=null,containerElement:l=null,openClass:u="show",closeClass:c="hide",isTopLevel:m=!0,parentMenu:h=null,hoverType:a="off",hoverDelay:d=250}){super({menuElement:e,menuItemSelector:t,menuLinkSelector:n,submenuItemSelector:s,submenuToggleSelector:r,submenuSelector:o,controllerElement:i,containerElement:l,openClass:u,closeClass:c,isTopLevel:m,parentMenu:h,hoverType:a,hoverDelay:d}),this.MenuType=T,this.MenuItemType=C,this.MenuToggleType=w,this.currentChild=-1,this.initialize()}initialize(){super.initialize(),this.handleFocus(),this.handleClick(),this.handleHover(),this.handleKeydown(),this.handleKeyup()}handleKeydown(){super.handleKeydown(),this.dom.menu.addEventListener("keydown",(e=>{this.currentEvent="keyboard";const t=g(e);if("self"===this.focusState){const n=["Space","Enter"],s=["Escape"],r=["Escape"];(["ArrowUp","ArrowRight","ArrowDown","ArrowLeft","Home","End"].includes(t)||this.currentMenuItem.isSubmenuItem&&n.includes(t)||this.elements.controller&&s.includes(t)||this.elements.parentMenu&&r.includes(t))&&b(e)}}))}handleKeyup(){super.handleKeyup(),this.dom.menu.addEventListener("keyup",(e=>{this.currentEvent="keyboard";const t=g(e);if("self"===this.focusState)if("Space"===t||"Enter"===t)this.currentMenuItem.isSubmenuItem&&(b(e),this.currentMenuItem.elements.toggle.preview());else if("Escape"===t){this.elements.submenuToggles.some((e=>e.isOpen))?(b(e),this.closeChildren()):this.elements.parentMenu?(b(e),this.elements.parentMenu.closeChildren(),this.elements.parentMenu.focusCurrentChild()):this.isTopLevel&&this.elements.controller&&this.elements.controller.isOpen&&(this.elements.controller.close(),this.focusController())}else"ArrowDown"===t||"ArrowRight"===t?(b(e),this.currentMenuItem.isSubmenuItem&&this.currentMenuItem.elements.toggle.isOpen?this.currentMenuItem.elements.childMenu.focusFirstChild():this.focusNextChild()):"ArrowUp"===t||"ArrowLeft"===t?(b(e),this.focusPreviousChild()):"Home"===t?(b(e),this.focusFirstChild()):"End"===t&&(b(e),this.focusLastChild())}))}focusNextChild(){this.currentChild<this.elements.menuItems.length-1&&(this.blurCurrentChild(),this.currentChild=this.currentChild+1,this.focusCurrentChild())}focusPreviousChild(){this.currentChild>0&&(this.blurCurrentChild(),this.currentChild=this.currentChild-1,this.focusCurrentChild())}}return{Menubar:M,DisclosureMenu:T}}();
